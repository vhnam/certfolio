---
import { getCollection, render } from "astro:content";
import Layout from "@/layouts/Layout.astro";

export async function getStaticPaths() {
  const entries = await getCollection("certificate");

  return entries.map((entry) => {
    // Map entry ID to a URL-friendly route slug.
    // "google-ux-design/index"           → "google-ux-design"
    // "google-ux-design/chapter-1/index" → "google-ux-design/chapter-1"
    // "google-ux-design/chapter-1/lesson-1" → "google-ux-design/chapter-1/lesson-1"
    const routeSlug = entry.id.replace(/\/index$/, "");

    return {
      params: { slug: routeSlug },
      props: { entry },
    };
  });
}

const { entry } = Astro.props;
const { Content, headings } = await render(entry);

const { title, description } = entry.data;
---

<Layout title={title} description={description} type="article">
  <article class="prose">
    <h1>{title}</h1>
    {description && <p class="lead">{description}</p>}
    <Content />
  </article>
</Layout>
